MODULE UTIL_TCFU_KEYS_MOD

USE YOMCFU_TYPE, ONLY : TCFU_KEYS


INTERFACE SAVE
MODULE PROCEDURE SAVE_TCFU_KEYS
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TCFU_KEYS
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TCFU_KEYS
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TCFU_KEYS
END INTERFACE



CONTAINS

SUBROUTINE SAVE_TCFU_KEYS (KLUN, YD)
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TCFU_KEYS), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%LCUMFU
WRITE (KLUN) YD%LSTRD
WRITE (KLUN) YD%LSTRC
WRITE (KLUN) YD%LSTRT
WRITE (KLUN) YD%LFPLC
WRITE (KLUN) YD%LFPLCG
WRITE (KLUN) YD%LFPLCH
WRITE (KLUN) YD%LFPLS
WRITE (KLUN) YD%LFPLSG
WRITE (KLUN) YD%LFPLSH
WRITE (KLUN) YD%LFR
WRITE (KLUN) YD%LAMIP
WRITE (KLUN) YD%LRAYS
WRITE (KLUN) YD%LRAYD
WRITE (KLUN) YD%LNEBTT
WRITE (KLUN) YD%LFSF
WRITE (KLUN) YD%LFSOIL
WRITE (KLUN) YD%LNEBPAR
WRITE (KLUN) YD%LTSTRD
WRITE (KLUN) YD%LTSTRC
WRITE (KLUN) YD%LTSTRT
WRITE (KLUN) YD%LTFPLC
WRITE (KLUN) YD%LTFPLS
WRITE (KLUN) YD%LTFR
WRITE (KLUN) YD%LTNEB
WRITE (KLUN) YD%LFDUTP
WRITE (KLUN) YD%LMOON
WRITE (KLUN) YD%LFRRC
WRITE (KLUN) YD%LFLASH
END SUBROUTINE

SUBROUTINE LOAD_TCFU_KEYS (KLUN, YD)
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TCFU_KEYS), INTENT (OUT), TARGET :: YD

READ (KLUN) YD%LCUMFU
READ (KLUN) YD%LSTRD
READ (KLUN) YD%LSTRC
READ (KLUN) YD%LSTRT
READ (KLUN) YD%LFPLC
READ (KLUN) YD%LFPLCG
READ (KLUN) YD%LFPLCH
READ (KLUN) YD%LFPLS
READ (KLUN) YD%LFPLSG
READ (KLUN) YD%LFPLSH
READ (KLUN) YD%LFR
READ (KLUN) YD%LAMIP
READ (KLUN) YD%LRAYS
READ (KLUN) YD%LRAYD
READ (KLUN) YD%LNEBTT
READ (KLUN) YD%LFSF
READ (KLUN) YD%LFSOIL
READ (KLUN) YD%LNEBPAR
READ (KLUN) YD%LTSTRD
READ (KLUN) YD%LTSTRC
READ (KLUN) YD%LTSTRT
READ (KLUN) YD%LTFPLC
READ (KLUN) YD%LTFPLS
READ (KLUN) YD%LTFR
READ (KLUN) YD%LTNEB
READ (KLUN) YD%LFDUTP
READ (KLUN) YD%LMOON
READ (KLUN) YD%LFRRC
READ (KLUN) YD%LFLASH
END SUBROUTINE


SUBROUTINE COPY_TCFU_KEYS (YD, LDCREATED)
IMPLICIT NONE
TYPE (TCFU_KEYS), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED
LOGICAL :: LLCREATED

LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$acc enter data create (YD)
  !$acc update device (YD)
ENDIF





























END SUBROUTINE

SUBROUTINE WIPE_TCFU_KEYS (YD, LDDELETED)
IMPLICIT NONE
TYPE (TCFU_KEYS), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED
LOGICAL :: LLDELETED






























LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$acc exit data delete (YD)
ENDIF
END SUBROUTINE



END MODULE
