MODULE UTIL_TPHY1_MOD

USE YOMPHY1, ONLY : TPHY1

INTERFACE SAVE
MODULE PROCEDURE SAVE_TPHY1
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TPHY1
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TPHY1
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TPHY1
END INTERFACE



CONTAINS

SUBROUTINE SAVE_TPHY1 (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TPHY1), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%GF3
WRITE (KLUN) YD%GF4
WRITE (KLUN) YD%TREF4
WRITE (KLUN) YD%RCTVEG
WRITE (KLUN) YD%RGL
WRITE (KLUN) YD%SODELX
WRITE (KLUN) YD%GCZ0H
WRITE (KLUN) YD%ALBGLA
WRITE (KLUN) YD%ALBMAX
WRITE (KLUN) YD%ALBMER
WRITE (KLUN) YD%ALBMED
WRITE (KLUN) YD%ALBMIN
WRITE (KLUN) YD%ALCRIN
WRITE (KLUN) YD%ALRCN1
WRITE (KLUN) YD%ALRCN2
WRITE (KLUN) YD%EA
WRITE (KLUN) YD%EC2REF
WRITE (KLUN) YD%EMCRIN
WRITE (KLUN) YD%EMMGLA
WRITE (KLUN) YD%EMMMER
WRITE (KLUN) YD%EWFC
WRITE (KLUN) YD%EWWILT
WRITE (KLUN) YD%GA
WRITE (KLUN) YD%GC1
WRITE (KLUN) YD%GC1S1
WRITE (KLUN) YD%GC1S2
WRITE (KLUN) YD%GC1S3
WRITE (KLUN) YD%GC1S4
WRITE (KLUN) YD%GC1Y1
WRITE (KLUN) YD%GTSVAP
WRITE (KLUN) YD%GVEGMX
WRITE (KLUN) YD%GLAIMX
WRITE (KLUN) YD%GNEIMX
WRITE (KLUN) YD%GWPIMX
WRITE (KLUN) YD%GCGEL
WRITE (KLUN) YD%GC2
WRITE (KLUN) YD%GC2REF
WRITE (KLUN) YD%GC3
WRITE (KLUN) YD%GC31
WRITE (KLUN) YD%GC32
WRITE (KLUN) YD%GCONV
WRITE (KLUN) YD%GF1
WRITE (KLUN) YD%GWFC
WRITE (KLUN) YD%GWLEX
WRITE (KLUN) YD%GWLMX
WRITE (KLUN) YD%GWWILT
WRITE (KLUN) YD%G1B
WRITE (KLUN) YD%G1CGSAT
WRITE (KLUN) YD%G1C1SAT
WRITE (KLUN) YD%G1P
WRITE (KLUN) YD%G1WSAT
WRITE (KLUN) YD%G2B
WRITE (KLUN) YD%G2CGSAT
WRITE (KLUN) YD%G2C1SAT
WRITE (KLUN) YD%G2P
WRITE (KLUN) YD%G2WSAT
WRITE (KLUN) YD%G3CGSAT
WRITE (KLUN) YD%GSNC1
WRITE (KLUN) YD%GSNC2
WRITE (KLUN) YD%HSOL
WRITE (KLUN) YD%HSOLIWR
WRITE (KLUN) YD%HSOLIT0
WRITE (KLUN) YD%OMTPRO
WRITE (KLUN) YD%OMWPRO
WRITE (KLUN) YD%RC1MAX
WRITE (KLUN) YD%RCTGLA
WRITE (KLUN) YD%RCGMAX
WRITE (KLUN) YD%RD1
WRITE (KLUN) YD%RD2GLA
WRITE (KLUN) YD%RD2MER
WRITE (KLUN) YD%RHOMAX
WRITE (KLUN) YD%RHOMIN
WRITE (KLUN) YD%RSMAX
WRITE (KLUN) YD%RTINER
WRITE (KLUN) YD%RZ0GLA
WRITE (KLUN) YD%RZ0MER
WRITE (KLUN) YD%RZHZ0G
WRITE (KLUN) YD%RZHZ0M
WRITE (KLUN) YD%TMERGL
WRITE (KLUN) YD%TOEXP
WRITE (KLUN) YD%TOLIN
WRITE (KLUN) YD%WCRIN
WRITE (KLUN) YD%WCRINC
WRITE (KLUN) YD%WCRING
WRITE (KLUN) YD%WNEW
WRITE (KLUN) YD%WPMX
WRITE (KLUN) YD%WSMX
WRITE (KLUN) YD%XCRINR
WRITE (KLUN) YD%XCRINV
WRITE (KLUN) YD%LALBMERCLIM
WRITE (KLUN) YD%LIMC
WRITE (KLUN) YD%LIMW
WRITE (KLUN) YD%LC1VAP
WRITE (KLUN) YD%LCLS_HS
WRITE (KLUN) YD%NTVGLA
WRITE (KLUN) YD%NTVMER
WRITE (KLUN) YD%GCGELS
WRITE (KLUN) YD%GVEGMXS
WRITE (KLUN) YD%GLAIMXS
WRITE (KLUN) YD%GNEIMXS
WRITE (KLUN) YD%ALB1
WRITE (KLUN) YD%ALB2
WRITE (KLUN) YD%RLAIMX
WRITE (KLUN) YD%RLAI
WRITE (KLUN) YD%ACLS_HS
WRITE (KLUN) YD%NCHSP
END SUBROUTINE

SUBROUTINE LOAD_TPHY1 (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TPHY1), INTENT (OUT), TARGET :: YD

READ (KLUN) YD%GF3
READ (KLUN) YD%GF4
READ (KLUN) YD%TREF4
READ (KLUN) YD%RCTVEG
READ (KLUN) YD%RGL
READ (KLUN) YD%SODELX
READ (KLUN) YD%GCZ0H
READ (KLUN) YD%ALBGLA
READ (KLUN) YD%ALBMAX
READ (KLUN) YD%ALBMER
READ (KLUN) YD%ALBMED
READ (KLUN) YD%ALBMIN
READ (KLUN) YD%ALCRIN
READ (KLUN) YD%ALRCN1
READ (KLUN) YD%ALRCN2
READ (KLUN) YD%EA
READ (KLUN) YD%EC2REF
READ (KLUN) YD%EMCRIN
READ (KLUN) YD%EMMGLA
READ (KLUN) YD%EMMMER
READ (KLUN) YD%EWFC
READ (KLUN) YD%EWWILT
READ (KLUN) YD%GA
READ (KLUN) YD%GC1
READ (KLUN) YD%GC1S1
READ (KLUN) YD%GC1S2
READ (KLUN) YD%GC1S3
READ (KLUN) YD%GC1S4
READ (KLUN) YD%GC1Y1
READ (KLUN) YD%GTSVAP
READ (KLUN) YD%GVEGMX
READ (KLUN) YD%GLAIMX
READ (KLUN) YD%GNEIMX
READ (KLUN) YD%GWPIMX
READ (KLUN) YD%GCGEL
READ (KLUN) YD%GC2
READ (KLUN) YD%GC2REF
READ (KLUN) YD%GC3
READ (KLUN) YD%GC31
READ (KLUN) YD%GC32
READ (KLUN) YD%GCONV
READ (KLUN) YD%GF1
READ (KLUN) YD%GWFC
READ (KLUN) YD%GWLEX
READ (KLUN) YD%GWLMX
READ (KLUN) YD%GWWILT
READ (KLUN) YD%G1B
READ (KLUN) YD%G1CGSAT
READ (KLUN) YD%G1C1SAT
READ (KLUN) YD%G1P
READ (KLUN) YD%G1WSAT
READ (KLUN) YD%G2B
READ (KLUN) YD%G2CGSAT
READ (KLUN) YD%G2C1SAT
READ (KLUN) YD%G2P
READ (KLUN) YD%G2WSAT
READ (KLUN) YD%G3CGSAT
READ (KLUN) YD%GSNC1
READ (KLUN) YD%GSNC2
READ (KLUN) YD%HSOL
READ (KLUN) YD%HSOLIWR
READ (KLUN) YD%HSOLIT0
READ (KLUN) YD%OMTPRO
READ (KLUN) YD%OMWPRO
READ (KLUN) YD%RC1MAX
READ (KLUN) YD%RCTGLA
READ (KLUN) YD%RCGMAX
READ (KLUN) YD%RD1
READ (KLUN) YD%RD2GLA
READ (KLUN) YD%RD2MER
READ (KLUN) YD%RHOMAX
READ (KLUN) YD%RHOMIN
READ (KLUN) YD%RSMAX
READ (KLUN) YD%RTINER
READ (KLUN) YD%RZ0GLA
READ (KLUN) YD%RZ0MER
READ (KLUN) YD%RZHZ0G
READ (KLUN) YD%RZHZ0M
READ (KLUN) YD%TMERGL
READ (KLUN) YD%TOEXP
READ (KLUN) YD%TOLIN
READ (KLUN) YD%WCRIN
READ (KLUN) YD%WCRINC
READ (KLUN) YD%WCRING
READ (KLUN) YD%WNEW
READ (KLUN) YD%WPMX
READ (KLUN) YD%WSMX
READ (KLUN) YD%XCRINR
READ (KLUN) YD%XCRINV
READ (KLUN) YD%LALBMERCLIM
READ (KLUN) YD%LIMC
READ (KLUN) YD%LIMW
READ (KLUN) YD%LC1VAP
READ (KLUN) YD%LCLS_HS
READ (KLUN) YD%NTVGLA
READ (KLUN) YD%NTVMER
READ (KLUN) YD%GCGELS
READ (KLUN) YD%GVEGMXS
READ (KLUN) YD%GLAIMXS
READ (KLUN) YD%GNEIMXS
READ (KLUN) YD%ALB1
READ (KLUN) YD%ALB2
READ (KLUN) YD%RLAIMX
READ (KLUN) YD%RLAI
READ (KLUN) YD%ACLS_HS
READ (KLUN) YD%NCHSP
END SUBROUTINE


SUBROUTINE COPY_TPHY1 (YD, LDCREATED)

IMPLICIT NONE
TYPE (TPHY1), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED
LOGICAL :: LLCREATED

LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$acc enter data create (YD)
  !$acc update device (YD)
ENDIF










































































































END SUBROUTINE

SUBROUTINE WIPE_TPHY1 (YD, LDDELETED)

IMPLICIT NONE
TYPE (TPHY1), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED
LOGICAL :: LLDELETED











































































































LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$acc exit data delete (YD)
ENDIF
END SUBROUTINE



END MODULE
