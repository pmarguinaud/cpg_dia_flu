MODULE UTIL_TEUVRAD_MOD

USE YOE_UVRAD, ONLY : TEUVRAD


INTERFACE SAVE
MODULE PROCEDURE SAVE_TEUVRAD
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TEUVRAD
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TEUVRAD
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TEUVRAD
END INTERFACE



CONTAINS

SUBROUTINE SAVE_TEUVRAD (KLUN, YD)
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TEUVRAD), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%NRADUV
WRITE (KLUN) YD%NUVTIM
WRITE (KLUN) YD%IPUV
WRITE (KLUN) YD%JCOP
WRITE (KLUN) YD%JUVLAM
WRITE (KLUN) YD%LUVPROC
WRITE (KLUN) YD%LUVTDEP
WRITE (KLUN) YD%LUVDBG
WRITE (KLUN) YD%LUVAERP
WRITE (KLUN) YD%LO3_CHEM_UV
WRITE (KLUN) YD%RK250
WRITE (KLUN) YD%RTUV1
WRITE (KLUN) YD%RTUV2
WRITE (KLUN) YD%RSUVB0
WRITE (KLUN) YD%RAYUVB
WRITE (KLUN) YD%RASA
WRITE (KLUN) YD%RASB
WRITE (KLUN) YD%RASC
WRITE (KLUN) YD%RASD
WRITE (KLUN) YD%RASE
WRITE (KLUN) YD%RASF
WRITE (KLUN) YD%RFA0
WRITE (KLUN) YD%RFA1
WRITE (KLUN) YD%RFB0
WRITE (KLUN) YD%RFB1
WRITE (KLUN) YD%RFB2
WRITE (KLUN) YD%RFB3
WRITE (KLUN) YD%RFC0
WRITE (KLUN) YD%RFC1
WRITE (KLUN) YD%RFC2
WRITE (KLUN) YD%RFC3
WRITE (KLUN) YD%RFD0
WRITE (KLUN) YD%RFD1
WRITE (KLUN) YD%RFD2
WRITE (KLUN) YD%RFD3
WRITE (KLUN) YD%RTAUVA
WRITE (KLUN) YD%RPIUVA
WRITE (KLUN) YD%RCGUVA
WRITE (KLUN) YD%RXPO
WRITE (KLUN) YD%RXPL
WRITE (KLUN) YD%RCIEAS
WRITE (KLUN) YD%RSUVB
WRITE (KLUN) YD%RUVLAM
WRITE (KLUN) YD%RFCAER
WRITE (KLUN) YD%RMUZUV
END SUBROUTINE

SUBROUTINE LOAD_TEUVRAD (KLUN, YD)
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TEUVRAD), INTENT (OUT), TARGET :: YD

READ (KLUN) YD%NRADUV
READ (KLUN) YD%NUVTIM
READ (KLUN) YD%IPUV
READ (KLUN) YD%JCOP
READ (KLUN) YD%JUVLAM
READ (KLUN) YD%LUVPROC
READ (KLUN) YD%LUVTDEP
READ (KLUN) YD%LUVDBG
READ (KLUN) YD%LUVAERP
READ (KLUN) YD%LO3_CHEM_UV
READ (KLUN) YD%RK250
READ (KLUN) YD%RTUV1
READ (KLUN) YD%RTUV2
READ (KLUN) YD%RSUVB0
READ (KLUN) YD%RAYUVB
READ (KLUN) YD%RASA
READ (KLUN) YD%RASB
READ (KLUN) YD%RASC
READ (KLUN) YD%RASD
READ (KLUN) YD%RASE
READ (KLUN) YD%RASF
READ (KLUN) YD%RFA0
READ (KLUN) YD%RFA1
READ (KLUN) YD%RFB0
READ (KLUN) YD%RFB1
READ (KLUN) YD%RFB2
READ (KLUN) YD%RFB3
READ (KLUN) YD%RFC0
READ (KLUN) YD%RFC1
READ (KLUN) YD%RFC2
READ (KLUN) YD%RFC3
READ (KLUN) YD%RFD0
READ (KLUN) YD%RFD1
READ (KLUN) YD%RFD2
READ (KLUN) YD%RFD3
READ (KLUN) YD%RTAUVA
READ (KLUN) YD%RPIUVA
READ (KLUN) YD%RCGUVA
READ (KLUN) YD%RXPO
READ (KLUN) YD%RXPL
READ (KLUN) YD%RCIEAS
READ (KLUN) YD%RSUVB
READ (KLUN) YD%RUVLAM
READ (KLUN) YD%RFCAER
READ (KLUN) YD%RMUZUV
END SUBROUTINE


SUBROUTINE COPY_TEUVRAD (YD, LDCREATED)
IMPLICIT NONE
TYPE (TEUVRAD), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED
LOGICAL :: LLCREATED

LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$acc enter data create (YD)
  !$acc update device (YD)
ENDIF













































END SUBROUTINE

SUBROUTINE WIPE_TEUVRAD (YD, LDDELETED)
IMPLICIT NONE
TYPE (TEUVRAD), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED
LOGICAL :: LLDELETED














































LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$acc exit data delete (YD)
ENDIF
END SUBROUTINE



END MODULE
