MODULE UTIL_TECUMF_MOD

USE YOECUMF, ONLY : TECUMF

INTERFACE SAVE
MODULE PROCEDURE SAVE_TECUMF
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TECUMF
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TECUMF
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TECUMF
END INTERFACE



CONTAINS

SUBROUTINE SAVE_TECUMF (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TECUMF), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%ENTRORG
WRITE (KLUN) YD%ENTR_RH
WRITE (KLUN) YD%ENTSHALP
WRITE (KLUN) YD%ENTSTPC1
WRITE (KLUN) YD%ENTSTPC2
WRITE (KLUN) YD%ENTRDD
WRITE (KLUN) YD%DETRPEN
WRITE (KLUN) YD%RMFCFL
WRITE (KLUN) YD%RMFLIA
WRITE (KLUN) YD%RMFSOLUV
WRITE (KLUN) YD%RMFSOLTQ
WRITE (KLUN) YD%RMFSOLCT
WRITE (KLUN) YD%RMFSOLRHS
WRITE (KLUN) YD%RMFADVW
WRITE (KLUN) YD%RMFADVWDD
WRITE (KLUN) YD%RMFCMIN
WRITE (KLUN) YD%RMFDEPS
WRITE (KLUN) YD%RDEPTHS
WRITE (KLUN) YD%RPRCON
WRITE (KLUN) YD%RTAUA
WRITE (KLUN) YD%RCAPDCYCL
WRITE (KLUN) YD%RMINCAPE
WRITE (KLUN) YD%RCPECONS
WRITE (KLUN) YD%RCVRFACTOR
WRITE (KLUN) YD%RCUCOV
WRITE (KLUN) YD%RTAUMEL
WRITE (KLUN) YD%RHEBC
WRITE (KLUN) YD%RUVPER
WRITE (KLUN) YD%RBASE0
WRITE (KLUN) YD%RMINCIN
WRITE (KLUN) YD%RXMIN
WRITE (KLUN) YD%RTAULIM
WRITE (KLUN) YD%RTAUFAC
WRITE (KLUN) YD%LMFPEN
WRITE (KLUN) YD%LMFSCV
WRITE (KLUN) YD%LMFMID
WRITE (KLUN) YD%LMFDD
WRITE (KLUN) YD%LMFDUDV
WRITE (KLUN) YD%LMFDSNOW
WRITE (KLUN) YD%LMFWETB
WRITE (KLUN) YD%LMFGLAC
WRITE (KLUN) YD%LSCVLIQ
WRITE (KLUN) YD%LNEWTAU
WRITE (KLUN) YD%LMFUVDIS
WRITE (KLUN) YD%LMFSMOOTH
WRITE (KLUN) YD%LMFWSTAR
WRITE (KLUN) YD%LMFCUCA
WRITE (KLUN) YD%LMFPROFP
WRITE (KLUN) YD%NJKT1
WRITE (KLUN) YD%NJKT2
WRITE (KLUN) YD%NJKT3
WRITE (KLUN) YD%NJKT4
WRITE (KLUN) YD%NJKT5
WRITE (KLUN) YD%NJKT6
WRITE (KLUN) YD%NJKT7
WRITE (KLUN) YD%NJKT8
END SUBROUTINE

SUBROUTINE LOAD_TECUMF (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TECUMF), INTENT (OUT), TARGET :: YD

READ (KLUN) YD%ENTRORG
READ (KLUN) YD%ENTR_RH
READ (KLUN) YD%ENTSHALP
READ (KLUN) YD%ENTSTPC1
READ (KLUN) YD%ENTSTPC2
READ (KLUN) YD%ENTRDD
READ (KLUN) YD%DETRPEN
READ (KLUN) YD%RMFCFL
READ (KLUN) YD%RMFLIA
READ (KLUN) YD%RMFSOLUV
READ (KLUN) YD%RMFSOLTQ
READ (KLUN) YD%RMFSOLCT
READ (KLUN) YD%RMFSOLRHS
READ (KLUN) YD%RMFADVW
READ (KLUN) YD%RMFADVWDD
READ (KLUN) YD%RMFCMIN
READ (KLUN) YD%RMFDEPS
READ (KLUN) YD%RDEPTHS
READ (KLUN) YD%RPRCON
READ (KLUN) YD%RTAUA
READ (KLUN) YD%RCAPDCYCL
READ (KLUN) YD%RMINCAPE
READ (KLUN) YD%RCPECONS
READ (KLUN) YD%RCVRFACTOR
READ (KLUN) YD%RCUCOV
READ (KLUN) YD%RTAUMEL
READ (KLUN) YD%RHEBC
READ (KLUN) YD%RUVPER
READ (KLUN) YD%RBASE0
READ (KLUN) YD%RMINCIN
READ (KLUN) YD%RXMIN
READ (KLUN) YD%RTAULIM
READ (KLUN) YD%RTAUFAC
READ (KLUN) YD%LMFPEN
READ (KLUN) YD%LMFSCV
READ (KLUN) YD%LMFMID
READ (KLUN) YD%LMFDD
READ (KLUN) YD%LMFDUDV
READ (KLUN) YD%LMFDSNOW
READ (KLUN) YD%LMFWETB
READ (KLUN) YD%LMFGLAC
READ (KLUN) YD%LSCVLIQ
READ (KLUN) YD%LNEWTAU
READ (KLUN) YD%LMFUVDIS
READ (KLUN) YD%LMFSMOOTH
READ (KLUN) YD%LMFWSTAR
READ (KLUN) YD%LMFCUCA
READ (KLUN) YD%LMFPROFP
READ (KLUN) YD%NJKT1
READ (KLUN) YD%NJKT2
READ (KLUN) YD%NJKT3
READ (KLUN) YD%NJKT4
READ (KLUN) YD%NJKT5
READ (KLUN) YD%NJKT6
READ (KLUN) YD%NJKT7
READ (KLUN) YD%NJKT8
END SUBROUTINE


SUBROUTINE COPY_TECUMF (YD, LDCREATED)

IMPLICIT NONE
TYPE (TECUMF), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED
LOGICAL :: LLCREATED

LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$acc enter data create (YD)
  !$acc update device (YD)
ENDIF
























































END SUBROUTINE

SUBROUTINE WIPE_TECUMF (YD, LDDELETED)

IMPLICIT NONE
TYPE (TECUMF), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED
LOGICAL :: LLDELETED

























































LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$acc exit data delete (YD)
ENDIF
END SUBROUTINE



END MODULE
