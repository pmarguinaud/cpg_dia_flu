MODULE UTIL_TDYNA_MOD

USE YOMDYNA, ONLY : TDYNA


INTERFACE SAVE
MODULE PROCEDURE SAVE_TDYNA
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TDYNA
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TDYNA
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TDYNA
END INTERFACE



CONTAINS

SUBROUTINE SAVE_TDYNA (KLUN, YD)
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
CLASS (TDYNA), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%NPDVAR
WRITE (KLUN) YD%NVDVAR
WRITE (KLUN) YD%ND4SYS
WRITE (KLUN) YD%LNHX
WRITE (KLUN) YD%LNHXDER
WRITE (KLUN) YD%LGWADV
WRITE (KLUN) YD%NGWADVSI
WRITE (KLUN) YD%LRDBBC
WRITE (KLUN) YD%LSI_NHEE
WRITE (KLUN) YD%LNHQE_C2
WRITE (KLUN) YD%LNHQE_SIHYD
WRITE (KLUN) YD%LNHEE_SVDLAPL_FIRST
WRITE (KLUN) YD%LSLHD
WRITE (KLUN) YD%LSLHD_W
WRITE (KLUN) YD%LSLHD_T
WRITE (KLUN) YD%LSLHD_SPD
WRITE (KLUN) YD%LSLHD_SVD
WRITE (KLUN) YD%LSLHD_GFL
WRITE (KLUN) YD%LSLHD_OLD
WRITE (KLUN) YD%LSLHD_STATIC
WRITE (KLUN) YD%LSLHDQUAD
WRITE (KLUN) YD%LSLHDVER
WRITE (KLUN) YD%SLHDKMIN
WRITE (KLUN) YD%SLHDKMAX
WRITE (KLUN) YD%SLHDKREF
WRITE (KLUN) YD%SLHDEPSH
WRITE (KLUN) YD%SLHDEPSV
WRITE (KLUN) YD%LGRADSP
WRITE (KLUN) YD%LGRADGP
WRITE (KLUN) YD%L3DTURB
WRITE (KLUN) YD%LSLDIA
WRITE (KLUN) YD%LRPRSLTRJ
WRITE (KLUN) YD%LRALTVDISP
WRITE (KLUN) YD%LVSPLIP
WRITE (KLUN) YD%LRHSVWENO
WRITE (KLUN) YD%LCOMAD
WRITE (KLUN) YD%LCOMADH
WRITE (KLUN) YD%LCOMADV
WRITE (KLUN) YD%LCOMAD_W
WRITE (KLUN) YD%LCOMAD_T
WRITE (KLUN) YD%LCOMAD_SPD
WRITE (KLUN) YD%LCOMAD_SVD
WRITE (KLUN) YD%LCOMAD_SP
WRITE (KLUN) YD%LCOMAD_GFL
WRITE (KLUN) YD%LNESCT
WRITE (KLUN) YD%LNESCV
WRITE (KLUN) YD%LNESC
WRITE (KLUN) YD%LSETTLST
WRITE (KLUN) YD%LSETTLSV
WRITE (KLUN) YD%LSETTLS
WRITE (KLUN) YD%LELTRA
WRITE (KLUN) YD%LSLINLC2
WRITE (KLUN) YD%LSLINL
WRITE (KLUN) YD%LHOISLT
WRITE (KLUN) YD%HOISLTV
WRITE (KLUN) YD%HOISLTH
WRITE (KLUN) YD%LSLTVWENO
WRITE (KLUN) YD%LAPRXPK
WRITE (KLUN) YD%NDLNPR
WRITE (KLUN) YD%RHYDR0
WRITE (KLUN) YD%LRUBC
WRITE (KLUN) YD%REXP_VRAT
WRITE (KLUN) YD%LNHEE_REFINE_SILAPL
WRITE (KLUN) YD%LNHEE_REFINE_GRP
WRITE (KLUN) YD%LNHEE_REFINE_PREH_BBC
WRITE (KLUN) YD%LVEREGINT
WRITE (KLUN) YD%LPC_FULL
WRITE (KLUN) YD%LPC_CHEAP
WRITE (KLUN) YD%LPC_CHEAP2
WRITE (KLUN) YD%LMIXETTLS
WRITE (KLUN) YD%LMIXETTLS_PRINT
WRITE (KLUN) YD%RMIXNL_TRH
WRITE (KLUN) YD%LDRY_ECMWF
WRITE (KLUN) YD%L_RDRY_VD
END SUBROUTINE

SUBROUTINE LOAD_TDYNA (KLUN, YD)
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
CLASS (TDYNA), INTENT (OUT), TARGET :: YD

READ (KLUN) YD%NPDVAR
READ (KLUN) YD%NVDVAR
READ (KLUN) YD%ND4SYS
READ (KLUN) YD%LNHX
READ (KLUN) YD%LNHXDER
READ (KLUN) YD%LGWADV
READ (KLUN) YD%NGWADVSI
READ (KLUN) YD%LRDBBC
READ (KLUN) YD%LSI_NHEE
READ (KLUN) YD%LNHQE_C2
READ (KLUN) YD%LNHQE_SIHYD
READ (KLUN) YD%LNHEE_SVDLAPL_FIRST
READ (KLUN) YD%LSLHD
READ (KLUN) YD%LSLHD_W
READ (KLUN) YD%LSLHD_T
READ (KLUN) YD%LSLHD_SPD
READ (KLUN) YD%LSLHD_SVD
READ (KLUN) YD%LSLHD_GFL
READ (KLUN) YD%LSLHD_OLD
READ (KLUN) YD%LSLHD_STATIC
READ (KLUN) YD%LSLHDQUAD
READ (KLUN) YD%LSLHDVER
READ (KLUN) YD%SLHDKMIN
READ (KLUN) YD%SLHDKMAX
READ (KLUN) YD%SLHDKREF
READ (KLUN) YD%SLHDEPSH
READ (KLUN) YD%SLHDEPSV
READ (KLUN) YD%LGRADSP
READ (KLUN) YD%LGRADGP
READ (KLUN) YD%L3DTURB
READ (KLUN) YD%LSLDIA
READ (KLUN) YD%LRPRSLTRJ
READ (KLUN) YD%LRALTVDISP
READ (KLUN) YD%LVSPLIP
READ (KLUN) YD%LRHSVWENO
READ (KLUN) YD%LCOMAD
READ (KLUN) YD%LCOMADH
READ (KLUN) YD%LCOMADV
READ (KLUN) YD%LCOMAD_W
READ (KLUN) YD%LCOMAD_T
READ (KLUN) YD%LCOMAD_SPD
READ (KLUN) YD%LCOMAD_SVD
READ (KLUN) YD%LCOMAD_SP
READ (KLUN) YD%LCOMAD_GFL
READ (KLUN) YD%LNESCT
READ (KLUN) YD%LNESCV
READ (KLUN) YD%LNESC
READ (KLUN) YD%LSETTLST
READ (KLUN) YD%LSETTLSV
READ (KLUN) YD%LSETTLS
READ (KLUN) YD%LELTRA
READ (KLUN) YD%LSLINLC2
READ (KLUN) YD%LSLINL
READ (KLUN) YD%LHOISLT
READ (KLUN) YD%HOISLTV
READ (KLUN) YD%HOISLTH
READ (KLUN) YD%LSLTVWENO
READ (KLUN) YD%LAPRXPK
READ (KLUN) YD%NDLNPR
READ (KLUN) YD%RHYDR0
READ (KLUN) YD%LRUBC
READ (KLUN) YD%REXP_VRAT
READ (KLUN) YD%LNHEE_REFINE_SILAPL
READ (KLUN) YD%LNHEE_REFINE_GRP
READ (KLUN) YD%LNHEE_REFINE_PREH_BBC
READ (KLUN) YD%LVEREGINT
READ (KLUN) YD%LPC_FULL
READ (KLUN) YD%LPC_CHEAP
READ (KLUN) YD%LPC_CHEAP2
READ (KLUN) YD%LMIXETTLS
READ (KLUN) YD%LMIXETTLS_PRINT
READ (KLUN) YD%RMIXNL_TRH
READ (KLUN) YD%LDRY_ECMWF
READ (KLUN) YD%L_RDRY_VD
END SUBROUTINE


SUBROUTINE COPY_TDYNA (YD, LDCREATED)
IMPLICIT NONE
CLASS (TDYNA), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED
LOGICAL :: LLCREATED

LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$acc enter data create (YD)
  !$acc update device (YD)
ENDIF










































































END SUBROUTINE

SUBROUTINE WIPE_TDYNA (YD, LDDELETED)
IMPLICIT NONE
CLASS (TDYNA), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED
LOGICAL :: LLDELETED











































































LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$acc exit data delete (YD)
ENDIF
END SUBROUTINE



END MODULE
