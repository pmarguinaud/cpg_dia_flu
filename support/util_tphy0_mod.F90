MODULE UTIL_TPHY0_MOD

USE YOMPHY0, ONLY : TPHY0


INTERFACE SAVE
MODULE PROCEDURE SAVE_TPHY0
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TPHY0
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TPHY0
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TPHY0
END INTERFACE



CONTAINS

SUBROUTINE SAVE_TPHY0 (KLUN, YD)
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TPHY0), INTENT (IN), TARGET :: YD
LOGICAL :: LRHUC, LRN1D, LRQSMOD, LRRC1D, LRSRC1D, LRSURF

WRITE (KLUN) YD%TYM
WRITE (KLUN) YD%NPCLO1
WRITE (KLUN) YD%NPCLO2
WRITE (KLUN) YD%A0ML_AU
WRITE (KLUN) YD%A0ML_AT
WRITE (KLUN) YD%A0ML_BU
WRITE (KLUN) YD%A0ML_BT
WRITE (KLUN) YD%AERCS1
WRITE (KLUN) YD%AERCS3
WRITE (KLUN) YD%AERCS5
WRITE (KLUN) YD%ADJTAU
WRITE (KLUN) YD%ALMAV
WRITE (KLUN) YD%BEDIFV
WRITE (KLUN) YD%ECMNP
WRITE (KLUN) YD%EDB
WRITE (KLUN) YD%EDC
WRITE (KLUN) YD%EDD
WRITE (KLUN) YD%EVAP
WRITE (KLUN) YD%FONT
WRITE (KLUN) YD%GALP
WRITE (KLUN) YD%GCISMIN
WRITE (KLUN) YD%GEVAVF
WRITE (KLUN) YD%GCCSV
WRITE (KLUN) YD%GCVADS
WRITE (KLUN) YD%GCVBETA
WRITE (KLUN) YD%GCVIMPT
WRITE (KLUN) YD%GCVOMGE
WRITE (KLUN) YD%GCVOMGQ
WRITE (KLUN) YD%GCVOMGS
WRITE (KLUN) YD%GCVTURB
WRITE (KLUN) YD%GCVOMDPS
WRITE (KLUN) YD%GCVOMGSX
WRITE (KLUN) YD%GCVRHMIN
WRITE (KLUN) YD%GCVRHMAX
WRITE (KLUN) YD%GCVOMCA
WRITE (KLUN) YD%GCVOMCC
WRITE (KLUN) YD%GDDEVA
WRITE (KLUN) YD%GDDSDE
WRITE (KLUN) YD%GDDFREVS
WRITE (KLUN) YD%GDDINHOM
WRITE (KLUN) YD%GRCVPP
WRITE (KLUN) YD%GWDAMP
WRITE (KLUN) YD%GWDBC
WRITE (KLUN) YD%GWDCCO
WRITE (KLUN) YD%GWDCD
WRITE (KLUN) YD%GWDLT
WRITE (KLUN) YD%GWDSE
WRITE (KLUN) YD%GWDPROF
WRITE (KLUN) YD%GWDVALI
WRITE (KLUN) YD%HOBST
WRITE (KLUN) YD%HUCOE
WRITE (KLUN) YD%HUTIL
WRITE (KLUN) YD%HUTIL1
WRITE (KLUN) YD%HUTIL2
WRITE (KLUN) YD%QSMIN
WRITE (KLUN) YD%QSMODC
WRITE (KLUN) YD%QSNEBC
WRITE (KLUN) YD%QSNEBS
WRITE (KLUN) YD%QSSUSC
WRITE (KLUN) YD%QSSUSS
WRITE (KLUN) YD%QSSUSV
WRITE (KLUN) YD%QSUSXC
WRITE (KLUN) YD%QSUSXS
WRITE (KLUN) YD%RPHI0
WRITE (KLUN) YD%RPHIR
WRITE (KLUN) YD%QXRAL
WRITE (KLUN) YD%QXRAL_ADJ
WRITE (KLUN) YD%QXRDEL
WRITE (KLUN) YD%QXRHX
WRITE (KLUN) YD%QXRR
WRITE (KLUN) YD%QXRTGH
WRITE (KLUN) YD%QXRCDIL
WRITE (KLUN) YD%RCIN
WRITE (KLUN) YD%RCVEVAP
WRITE (KLUN) YD%RDECRD
WRITE (KLUN) YD%RDECRD1
WRITE (KLUN) YD%RDECRD2
WRITE (KLUN) YD%RDECRD3
WRITE (KLUN) YD%RDECRD4
WRITE (KLUN) YD%RDECRDRED
WRITE (KLUN) YD%RDTFAC
WRITE (KLUN) YD%REVAPN
WRITE (KLUN) YD%REVGSL
WRITE (KLUN) YD%RGELSFON
WRITE (KLUN) YD%RFLCHCE
WRITE (KLUN) YD%RTCAPE
WRITE (KLUN) YD%SCO
WRITE (KLUN) YD%SENSL
WRITE (KLUN) YD%SNNBCO
WRITE (KLUN) YD%SPNBCO
WRITE (KLUN) YD%SXNBCO
WRITE (KLUN) YD%TCA
WRITE (KLUN) YD%TCT
WRITE (KLUN) YD%TCW
WRITE (KLUN) YD%TENTR
WRITE (KLUN) YD%TENTRX
WRITE (KLUN) YD%TUDGP
WRITE (KLUN) YD%TDDGP
WRITE (KLUN) YD%TURB
WRITE (KLUN) YD%TVF
WRITE (KLUN) YD%UHDIFV
WRITE (KLUN) YD%USDMLT
WRITE (KLUN) YD%USUPRC
WRITE (KLUN) YD%USURIC
WRITE (KLUN) YD%VCHRNK
WRITE (KLUN) YD%VKARMN
WRITE (KLUN) YD%VZ0CM
WRITE (KLUN) YD%VZIUSTAR0
WRITE (KLUN) YD%XNBMAX
WRITE (KLUN) YD%AECLS3
WRITE (KLUN) YD%AECLS4
WRITE (KLUN) YD%ALD
WRITE (KLUN) YD%AKN
WRITE (KLUN) YD%ALPHAT
WRITE (KLUN) YD%ALPHAE
WRITE (KLUN) YD%EPS
WRITE (KLUN) YD%ETACUT
WRITE (KLUN) YD%ADISI
WRITE (KLUN) YD%ADISE
WRITE (KLUN) YD%ECTMIN
WRITE (KLUN) YD%ECTMAX
WRITE (KLUN) YD%AHCLPV
WRITE (KLUN) YD%RICRLM
WRITE (KLUN) YD%RMULACVG
WRITE (KLUN) YD%XBLM
WRITE (KLUN) YD%XMINLM
WRITE (KLUN) YD%XMAXLM
WRITE (KLUN) YD%XWSALM
WRITE (KLUN) YD%XWSBLM
WRITE (KLUN) YD%GCVALFA
WRITE (KLUN) YD%GCVPSI
WRITE (KLUN) YD%GCVPSIE
WRITE (KLUN) YD%USURICE
WRITE (KLUN) YD%USURICL
WRITE (KLUN) YD%QSSC
WRITE (KLUN) YD%USURID
WRITE (KLUN) YD%GCVNU
WRITE (KLUN) YD%USURIDE
WRITE (KLUN) YD%GCVMLT
WRITE (KLUN) YD%UTILGUST
WRITE (KLUN) YD%RRGAMMA
WRITE (KLUN) YD%RRSCALE
WRITE (KLUN) YD%GPBLHK0
WRITE (KLUN) YD%GPBLHRA
WRITE (KLUN) YD%WMXOV
WRITE (KLUN) YD%ACBRPHIM
WRITE (KLUN) YD%ALMAVE
WRITE (KLUN) YD%ALMAVX
WRITE (KLUN) YD%ARSCH
WRITE (KLUN) YD%ARSCQ
WRITE (KLUN) YD%ARSC1
WRITE (KLUN) YD%ARSB2
WRITE (KLUN) YD%RICRET
WRITE (KLUN) YD%STTBMIN
WRITE (KLUN) YD%UCWSTAR
WRITE (KLUN) YD%UDECT
WRITE (KLUN) YD%UPRETMIN
WRITE (KLUN) YD%UPRETMAX
WRITE (KLUN) YD%USHEARM
WRITE (KLUN) YD%RAUTEFR
WRITE (KLUN) YD%RRAUTCS
WRITE (KLUN) YD%RAUTEFS
WRITE (KLUN) YD%RAUTSBET
WRITE (KLUN) YD%RAUTEFG
WRITE (KLUN) YD%REVASX
WRITE (KLUN) YD%RNINTR
WRITE (KLUN) YD%RNINTS
WRITE (KLUN) YD%RQLCR
WRITE (KLUN) YD%RSPCRR
WRITE (KLUN) YD%RQICRMAX
WRITE (KLUN) YD%RQICRMIN
WRITE (KLUN) YD%RQLCV
WRITE (KLUN) YD%RQICVMAX
WRITE (KLUN) YD%RQICVMIN
WRITE (KLUN) YD%RQICRT1
WRITE (KLUN) YD%RQICRT2
WRITE (KLUN) YD%RQICRSN
WRITE (KLUN) YD%RQCRNS
WRITE (KLUN) YD%RACCEF
WRITE (KLUN) YD%RAGGEF
WRITE (KLUN) YD%RRIMEF
WRITE (KLUN) YD%RHCRIT1
WRITE (KLUN) YD%RHCRIT2
WRITE (KLUN) YD%RETAMIN
WRITE (KLUN) YD%RFACNSM
WRITE (KLUN) YD%TFVL
WRITE (KLUN) YD%TFVI
WRITE (KLUN) YD%TFVR
WRITE (KLUN) YD%TFVS
WRITE (KLUN) YD%GRHCMOD
WRITE (KLUN) YD%RHCEXPDX
WRITE (KLUN) YD%NUPTKE
WRITE (KLUN) YD%TKEMULT
WRITE (KLUN) YD%C_EPSILON
WRITE (KLUN) YD%C3TKEFREE
WRITE (KLUN) YD%ETKE_CTHETA
WRITE (KLUN) YD%ETKE_RIFC_MAF
WRITE (KLUN) YD%ETKE_RIFC
WRITE (KLUN) YD%ETKE_R
WRITE (KLUN) YD%ETKE_OLAM
WRITE (KLUN) YD%ETKE_LAM0
WRITE (KLUN) YD%ETKE_LAM1
WRITE (KLUN) YD%ETKE_LAM2
WRITE (KLUN) YD%ETKE_LAM3
WRITE (KLUN) YD%ETKE_LAM4
WRITE (KLUN) YD%ETKE_KA1
WRITE (KLUN) YD%ETKE_KA2
WRITE (KLUN) YD%ETKE_KA3
WRITE (KLUN) YD%ENT_LAMBDA
WRITE (KLUN) YD%ETKE_CG01
WRITE (KLUN) YD%ETKE_CG02
WRITE (KLUN) YD%ETKE_CG03
WRITE (KLUN) YD%ETKE_BETA_EPS
WRITE (KLUN) YD%ETKE_GAMMA_EPS
WRITE (KLUN) YD%ETKE_GAMD
WRITE (KLUN) YD%ETKE_TALPH
WRITE (KLUN) YD%ETKE_ALPH0
WRITE (KLUN) YD%ETKE_ENTRX
WRITE (KLUN) YD%ETKE_ENTRN
WRITE (KLUN) YD%ETKE_KLM
WRITE (KLUN) YD%ETKE_TAULM
WRITE (KLUN) YD%ETKE_C0SHEAR
WRITE (KLUN) YD%ETKE_R1SIM
WRITE (KLUN) YD%ETKE_R2SIM
WRITE (KLUN) YD%ETKE_GB08A
WRITE (KLUN) YD%ETKE_GB08B
WRITE (KLUN) YD%ETKE_MIN
WRITE (KLUN) YD%ETKE_CRIT
WRITE (KLUN) YD%ETKE_DELTA
WRITE (KLUN) YD%EFB_AZ0
WRITE (KLUN) YD%EFB_UR
WRITE (KLUN) YD%REFB_1
WRITE (KLUN) YD%REFB_2
WRITE (KLUN) YD%REFB_3
WRITE (KLUN) YD%TUDBU
WRITE (KLUN) YD%TDDBU
WRITE (KLUN) YD%TUDFR
WRITE (KLUN) YD%TDDFR
WRITE (KLUN) YD%GCVALMX
WRITE (KLUN) YD%GCVTAUDE
WRITE (KLUN) YD%GCVACHI
WRITE (KLUN) YD%GCVBEE
WRITE (KLUN) YD%GCVEEX
WRITE (KLUN) YD%ECMNPI
WRITE (KLUN) YD%GRRMINA
WRITE (KLUN) YD%GDDBETA
WRITE (KLUN) YD%GDDDP
WRITE (KLUN) YD%GDDFXM
WRITE (KLUN) YD%GDDWPF
WRITE (KLUN) YD%GDDEVF
WRITE (KLUN) YD%TENTRD
WRITE (KLUN) YD%GDDALBU
WRITE (KLUN) YD%GDDFRAC
WRITE (KLUN) YD%GDDENDYMX
WRITE (KLUN) YD%GDDFP
WRITE (KLUN) YD%GDDTAUSIG
WRITE (KLUN) YD%GPEIPHI
WRITE (KLUN) YD%GPETAU
WRITE (KLUN) YD%GPEFDC
WRITE (KLUN) YD%GENVSRH
WRITE (KLUN) YD%GCVKSKV
WRITE (KLUN) YD%GCVALBU
WRITE (KLUN) YD%GCVENDY1
WRITE (KLUN) YD%GCVENDY2
WRITE (KLUN) YD%GCVENDYMX
WRITE (KLUN) YD%GCVIDPBAS
WRITE (KLUN) YD%GCVTAUSIG
WRITE (KLUN) YD%GTRGDPMIX
WRITE (KLUN) YD%GTRGDPHIMN
WRITE (KLUN) YD%GTRGPUSLMN
WRITE (KLUN) YD%GTRGKCK9
WRITE (KLUN) YD%GTRGAIN
WRITE (KLUN) YD%GTRTHRS
WRITE (KLUN) YD%GTRTHCK
WRITE (KLUN) YD%GTRBRC
WRITE (KLUN) YD%GTRKGAIN
WRITE (KLUN) YD%GTRKTHRS
WRITE (KLUN) YD%GTRKTHCK
WRITE (KLUN) YD%GCVCATAU
WRITE (KLUN) YD%GCATHRCAP
WRITE (KLUN) YD%GCATHRMOC
WRITE (KLUN) YD%GCATHRCND
WRITE (KLUN) YD%GCAOMCND
WRITE (KLUN) YD%NWEIGHT
WRITE (KLUN) YD%NCATAU
WRITE (KLUN) YD%NCAPEMAX
WRITE (KLUN) YD%NCVGMAX
WRITE (KLUN) YD%RNEGAT
WRITE (KLUN) YD%RNLCURV
WRITE (KLUN) YD%EDK
WRITE (KLUN) YD%XKLM
WRITE (KLUN) YD%AGRE1
WRITE (KLUN) YD%AGRERICR
WRITE (KLUN) YD%AJBUMIN
WRITE (KLUN) YD%RCOFLM
WRITE (KLUN) YD%TENTRVL
WRITE (KLUN) YD%TRENTRV
WRITE (KLUN) YD%GCVGAMMA
WRITE (KLUN) YD%LKESC
WRITE (KLUN) YD%AGRE2
WRITE (KLUN) YD%AGREF
WRITE (KLUN) YD%ALFX
WRITE (KLUN) YD%ALFX_LR
WRITE (KLUN) YD%ALFX_HR
WRITE (KLUN) YD%TCTC
WRITE (KLUN) YD%TVFC
WRITE (KLUN) YD%GAMAP1
WRITE (KLUN) YD%RKDN
WRITE (KLUN) YD%VVN
WRITE (KLUN) YD%VVX
WRITE (KLUN) YD%FENTRT
WRITE (KLUN) YD%FQLIC
WRITE (KLUN) YD%FNEBC
WRITE (KLUN) YD%FEVAPC
WRITE (KLUN) YD%RDPHIC
WRITE (KLUN) YD%RWBF1
WRITE (KLUN) YD%RWBF2
WRITE (KLUN) YD%SCLESPR
WRITE (KLUN) YD%SCLESPS
WRITE (KLUN) YD%HUCRED
WRITE (KLUN) YD%HUCREDRA
WRITE (KLUN) YD%FSPRAIN
WRITE (KLUN) YD%EFFCOLL
WRITE (KLUN) YD%RSMDNEBX
WRITE (KLUN) YD%RSMDTX
WRITE (KLUN) YD%NSMTPA
WRITE (KLUN) YD%NSMTPB
WRITE (KLUN) YD%RKFBTAU
WRITE (KLUN) YD%RKFBNBX
WRITE (KLUN) YD%GCVHMIN
WRITE (KLUN) YD%GCVRESN
WRITE (KLUN) YD%GCVRESX
WRITE (KLUN) YD%GMIRH
WRITE (KLUN) YD%RLMLH1
WRITE (KLUN) YD%RPRTH
WRITE (KLUN) YD%RSMOOTHMELT
WRITE (KLUN) YD%LADVLIM
WRITE (KLUN) YD%LGDDD
WRITE (KLUN) YD%LCVNHD
WRITE (KLUN) YD%LCVRESDYN
WRITE (KLUN) YD%LCVMICC
WRITE (KLUN) YD%GMUKEDD
WRITE (KLUN) YD%GNHDTAT
WRITE (KLUN) YD%GNHDSMOS
WRITE (KLUN) YD%GNHDSMOT
WRITE (KLUN) YD%GNHDEV
WRITE (KLUN) YD%LGVVEX
WRITE (KLUN) YD%LCVUVM
WRITE (KLUN) YD%NCVENTR
WRITE (KLUN) YD%NCVSIG
WRITE (KLUN) YD%NCVCLOS
WRITE (KLUN) YD%NCVQLI
WRITE (KLUN) YD%GCVENTRN
WRITE (KLUN) YD%GCVENTRX
WRITE (KLUN) YD%ADOE
WRITE (KLUN) YD%RFRAC_ENTR_N
WRITE (KLUN) YD%RFRAC_ENTR_X
WRITE (KLUN) YD%GCVENTR_MIN
WRITE (KLUN) YD%THPCMT
WRITE (KLUN) YD%AJ1PEPS
WRITE (KLUN) YD%AJ1MEPS
WRITE (KLUN) YD%NAJITER
WRITE (KLUN) YD%GAEPS
WRITE (KLUN) YD%GCVEZ
WRITE (KLUN) YD%GCVTRMIN
WRITE (KLUN) YD%LCVFEVV
WRITE (KLUN) YD%GCVFEVV
WRITE (KLUN) YD%LCVCONTAU
WRITE (KLUN) YD%GCVTEXC
WRITE (KLUN) YD%GCVWEXC
WRITE (KLUN) YD%LCVNAUV
WRITE (KLUN) YD%GCVFRR
WRITE (KLUN) YD%GCVPNH
WRITE (KLUN) YD%GCVORGED
WRITE (KLUN) YD%LCVIMPT
WRITE (KLUN) YD%GCVTAUREM
WRITE (KLUN) YD%GCLOEA
WRITE (KLUN) YD%GCLOEB
WRITE (KLUN) YD%GFRAE
WRITE (KLUN) YD%GCVADET
WRITE (KLUN) YD%GCVCINC
WRITE (KLUN) YD%GSDMIN
WRITE (KLUN) YD%GSDMAX
WRITE (KLUN) YD%GALMIN
WRITE (KLUN) YD%GALMAX
WRITE (KLUN) YD%GSDAMIN
WRITE (KLUN) YD%GSDAMAX
WRITE (KLUN) YD%GEXPKD
WRITE (KLUN) YD%LCVEOD
WRITE (KLUN) YD%GREMIN
WRITE (KLUN) YD%GREMAX
WRITE (KLUN) YD%GCHI0
WRITE (KLUN) YD%GFSURF
WRITE (KLUN) YD%GSHELL
WRITE (KLUN) YD%GFRIC
WRITE (KLUN) YD%GUDDD
WRITE (KLUN) YD%GSIGA
WRITE (KLUN) YD%GNHDSMOW
WRITE (KLUN) YD%GDEPTH
WRITE (KLUN) YD%GALTAU
WRITE (KLUN) YD%GKEDDRE
WRITE (KLUN) YD%GNHACC
WRITE (KLUN) YD%GTDCL
WRITE (KLUN) YD%GSINHD
WRITE (KLUN) YD%GSINHR
WRITE (KLUN) YD%GCVFNER
WRITE (KLUN) YD%GCVFNEO
WRITE (KLUN) YD%GCVFNEP1
WRITE (KLUN) YD%GCVFNEP2
WRITE (KLUN) YD%GRBCC
WRITE (KLUN) YD%GTOPDEPTH
WRITE (KLUN) YD%GCVTSMO
WRITE (KLUN) YD%RKDX
WRITE (KLUN) YD%LCAPCIN
WRITE (KLUN) YD%LCORSEDIM
WRITE (KLUN) YD%GNHDTAU
WRITE (KLUN) YD%GRSO
WRITE (KLUN) YD%GRTH
WRITE (KLUN) YD%GRFCS
WRITE (KLUN) YD%GCVRE
WRITE (KLUN) YD%LSBUO
WRITE (KLUN) YD%GREDDI
WRITE (KLUN) YD%GREDDL
WRITE (KLUN) YD%GREDDR
WRITE (KLUN) YD%GREDDS
WRITE (KLUN) YD%LCVTADV
WRITE (KLUN) YD%LCVDS
WRITE (KLUN) YD%GCVUV
WRITE (KLUN) YD%GCVGAW
WRITE (KLUN) YD%GCVGAX
WRITE (KLUN) YD%GCHECKMV_TMIN
WRITE (KLUN) YD%GCHECKMV_TMAX
WRITE (KLUN) YD%GCHECKMV_QVMIN
WRITE (KLUN) YD%GCHECKMV_QVMAX
WRITE (KLUN) YD%LGPRONI1
WRITE (KLUN) YD%NPRONI
WRITE (KLUN) YD%GPRONI
WRITE (KLUN) YD%RNEBCX
WRITE (KLUN) YD%GLIGHTT1
WRITE (KLUN) YD%GLIGHTT2
WRITE (KLUN) YD%GLIGHTT3
WRITE (KLUN) YD%REFLRHC
WRITE (KLUN) YD%TEQH
WRITE (KLUN) YD%REFLKUO
WRITE (KLUN) YD%REFLCAPE
WRITE (KLUN) YD%TEQK
WRITE (KLUN) YD%TEQC
WRITE (KLUN) YD%REPS
LRHUC = ALLOCATED (YD%RHUC)
WRITE (KLUN) LRHUC
IF (LRHUC) THEN
  WRITE (KLUN) LBOUND (YD%RHUC)
  WRITE (KLUN) UBOUND (YD%RHUC)
  WRITE (KLUN) YD%RHUC
ENDIF
LRQSMOD = ALLOCATED (YD%RQSMOD)
WRITE (KLUN) LRQSMOD
IF (LRQSMOD) THEN
  WRITE (KLUN) LBOUND (YD%RQSMOD)
  WRITE (KLUN) UBOUND (YD%RQSMOD)
  WRITE (KLUN) YD%RQSMOD
ENDIF
LRSURF = ALLOCATED (YD%RSURF)
WRITE (KLUN) LRSURF
IF (LRSURF) THEN
  WRITE (KLUN) LBOUND (YD%RSURF)
  WRITE (KLUN) UBOUND (YD%RSURF)
  WRITE (KLUN) YD%RSURF
ENDIF
LRN1D = ALLOCATED (YD%RN1D)
WRITE (KLUN) LRN1D
IF (LRN1D) THEN
  WRITE (KLUN) LBOUND (YD%RN1D)
  WRITE (KLUN) UBOUND (YD%RN1D)
  WRITE (KLUN) YD%RN1D
ENDIF
LRRC1D = ALLOCATED (YD%RRC1D)
WRITE (KLUN) LRRC1D
IF (LRRC1D) THEN
  WRITE (KLUN) LBOUND (YD%RRC1D)
  WRITE (KLUN) UBOUND (YD%RRC1D)
  WRITE (KLUN) YD%RRC1D
ENDIF
LRSRC1D = ALLOCATED (YD%RSRC1D)
WRITE (KLUN) LRSRC1D
IF (LRSRC1D) THEN
  WRITE (KLUN) LBOUND (YD%RSRC1D)
  WRITE (KLUN) UBOUND (YD%RSRC1D)
  WRITE (KLUN) YD%RSRC1D
ENDIF
WRITE (KLUN) YD%RCOEFRAIN
WRITE (KLUN) YD%RCOEFSNOW
END SUBROUTINE

SUBROUTINE LOAD_TPHY0 (KLUN, YD)
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TPHY0), INTENT (OUT), TARGET :: YD
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LRHUC, LRN1D, LRQSMOD, LRRC1D, LRSRC1D, LRSURF

READ (KLUN) YD%TYM
READ (KLUN) YD%NPCLO1
READ (KLUN) YD%NPCLO2
READ (KLUN) YD%A0ML_AU
READ (KLUN) YD%A0ML_AT
READ (KLUN) YD%A0ML_BU
READ (KLUN) YD%A0ML_BT
READ (KLUN) YD%AERCS1
READ (KLUN) YD%AERCS3
READ (KLUN) YD%AERCS5
READ (KLUN) YD%ADJTAU
READ (KLUN) YD%ALMAV
READ (KLUN) YD%BEDIFV
READ (KLUN) YD%ECMNP
READ (KLUN) YD%EDB
READ (KLUN) YD%EDC
READ (KLUN) YD%EDD
READ (KLUN) YD%EVAP
READ (KLUN) YD%FONT
READ (KLUN) YD%GALP
READ (KLUN) YD%GCISMIN
READ (KLUN) YD%GEVAVF
READ (KLUN) YD%GCCSV
READ (KLUN) YD%GCVADS
READ (KLUN) YD%GCVBETA
READ (KLUN) YD%GCVIMPT
READ (KLUN) YD%GCVOMGE
READ (KLUN) YD%GCVOMGQ
READ (KLUN) YD%GCVOMGS
READ (KLUN) YD%GCVTURB
READ (KLUN) YD%GCVOMDPS
READ (KLUN) YD%GCVOMGSX
READ (KLUN) YD%GCVRHMIN
READ (KLUN) YD%GCVRHMAX
READ (KLUN) YD%GCVOMCA
READ (KLUN) YD%GCVOMCC
READ (KLUN) YD%GDDEVA
READ (KLUN) YD%GDDSDE
READ (KLUN) YD%GDDFREVS
READ (KLUN) YD%GDDINHOM
READ (KLUN) YD%GRCVPP
READ (KLUN) YD%GWDAMP
READ (KLUN) YD%GWDBC
READ (KLUN) YD%GWDCCO
READ (KLUN) YD%GWDCD
READ (KLUN) YD%GWDLT
READ (KLUN) YD%GWDSE
READ (KLUN) YD%GWDPROF
READ (KLUN) YD%GWDVALI
READ (KLUN) YD%HOBST
READ (KLUN) YD%HUCOE
READ (KLUN) YD%HUTIL
READ (KLUN) YD%HUTIL1
READ (KLUN) YD%HUTIL2
READ (KLUN) YD%QSMIN
READ (KLUN) YD%QSMODC
READ (KLUN) YD%QSNEBC
READ (KLUN) YD%QSNEBS
READ (KLUN) YD%QSSUSC
READ (KLUN) YD%QSSUSS
READ (KLUN) YD%QSSUSV
READ (KLUN) YD%QSUSXC
READ (KLUN) YD%QSUSXS
READ (KLUN) YD%RPHI0
READ (KLUN) YD%RPHIR
READ (KLUN) YD%QXRAL
READ (KLUN) YD%QXRAL_ADJ
READ (KLUN) YD%QXRDEL
READ (KLUN) YD%QXRHX
READ (KLUN) YD%QXRR
READ (KLUN) YD%QXRTGH
READ (KLUN) YD%QXRCDIL
READ (KLUN) YD%RCIN
READ (KLUN) YD%RCVEVAP
READ (KLUN) YD%RDECRD
READ (KLUN) YD%RDECRD1
READ (KLUN) YD%RDECRD2
READ (KLUN) YD%RDECRD3
READ (KLUN) YD%RDECRD4
READ (KLUN) YD%RDECRDRED
READ (KLUN) YD%RDTFAC
READ (KLUN) YD%REVAPN
READ (KLUN) YD%REVGSL
READ (KLUN) YD%RGELSFON
READ (KLUN) YD%RFLCHCE
READ (KLUN) YD%RTCAPE
READ (KLUN) YD%SCO
READ (KLUN) YD%SENSL
READ (KLUN) YD%SNNBCO
READ (KLUN) YD%SPNBCO
READ (KLUN) YD%SXNBCO
READ (KLUN) YD%TCA
READ (KLUN) YD%TCT
READ (KLUN) YD%TCW
READ (KLUN) YD%TENTR
READ (KLUN) YD%TENTRX
READ (KLUN) YD%TUDGP
READ (KLUN) YD%TDDGP
READ (KLUN) YD%TURB
READ (KLUN) YD%TVF
READ (KLUN) YD%UHDIFV
READ (KLUN) YD%USDMLT
READ (KLUN) YD%USUPRC
READ (KLUN) YD%USURIC
READ (KLUN) YD%VCHRNK
READ (KLUN) YD%VKARMN
READ (KLUN) YD%VZ0CM
READ (KLUN) YD%VZIUSTAR0
READ (KLUN) YD%XNBMAX
READ (KLUN) YD%AECLS3
READ (KLUN) YD%AECLS4
READ (KLUN) YD%ALD
READ (KLUN) YD%AKN
READ (KLUN) YD%ALPHAT
READ (KLUN) YD%ALPHAE
READ (KLUN) YD%EPS
READ (KLUN) YD%ETACUT
READ (KLUN) YD%ADISI
READ (KLUN) YD%ADISE
READ (KLUN) YD%ECTMIN
READ (KLUN) YD%ECTMAX
READ (KLUN) YD%AHCLPV
READ (KLUN) YD%RICRLM
READ (KLUN) YD%RMULACVG
READ (KLUN) YD%XBLM
READ (KLUN) YD%XMINLM
READ (KLUN) YD%XMAXLM
READ (KLUN) YD%XWSALM
READ (KLUN) YD%XWSBLM
READ (KLUN) YD%GCVALFA
READ (KLUN) YD%GCVPSI
READ (KLUN) YD%GCVPSIE
READ (KLUN) YD%USURICE
READ (KLUN) YD%USURICL
READ (KLUN) YD%QSSC
READ (KLUN) YD%USURID
READ (KLUN) YD%GCVNU
READ (KLUN) YD%USURIDE
READ (KLUN) YD%GCVMLT
READ (KLUN) YD%UTILGUST
READ (KLUN) YD%RRGAMMA
READ (KLUN) YD%RRSCALE
READ (KLUN) YD%GPBLHK0
READ (KLUN) YD%GPBLHRA
READ (KLUN) YD%WMXOV
READ (KLUN) YD%ACBRPHIM
READ (KLUN) YD%ALMAVE
READ (KLUN) YD%ALMAVX
READ (KLUN) YD%ARSCH
READ (KLUN) YD%ARSCQ
READ (KLUN) YD%ARSC1
READ (KLUN) YD%ARSB2
READ (KLUN) YD%RICRET
READ (KLUN) YD%STTBMIN
READ (KLUN) YD%UCWSTAR
READ (KLUN) YD%UDECT
READ (KLUN) YD%UPRETMIN
READ (KLUN) YD%UPRETMAX
READ (KLUN) YD%USHEARM
READ (KLUN) YD%RAUTEFR
READ (KLUN) YD%RRAUTCS
READ (KLUN) YD%RAUTEFS
READ (KLUN) YD%RAUTSBET
READ (KLUN) YD%RAUTEFG
READ (KLUN) YD%REVASX
READ (KLUN) YD%RNINTR
READ (KLUN) YD%RNINTS
READ (KLUN) YD%RQLCR
READ (KLUN) YD%RSPCRR
READ (KLUN) YD%RQICRMAX
READ (KLUN) YD%RQICRMIN
READ (KLUN) YD%RQLCV
READ (KLUN) YD%RQICVMAX
READ (KLUN) YD%RQICVMIN
READ (KLUN) YD%RQICRT1
READ (KLUN) YD%RQICRT2
READ (KLUN) YD%RQICRSN
READ (KLUN) YD%RQCRNS
READ (KLUN) YD%RACCEF
READ (KLUN) YD%RAGGEF
READ (KLUN) YD%RRIMEF
READ (KLUN) YD%RHCRIT1
READ (KLUN) YD%RHCRIT2
READ (KLUN) YD%RETAMIN
READ (KLUN) YD%RFACNSM
READ (KLUN) YD%TFVL
READ (KLUN) YD%TFVI
READ (KLUN) YD%TFVR
READ (KLUN) YD%TFVS
READ (KLUN) YD%GRHCMOD
READ (KLUN) YD%RHCEXPDX
READ (KLUN) YD%NUPTKE
READ (KLUN) YD%TKEMULT
READ (KLUN) YD%C_EPSILON
READ (KLUN) YD%C3TKEFREE
READ (KLUN) YD%ETKE_CTHETA
READ (KLUN) YD%ETKE_RIFC_MAF
READ (KLUN) YD%ETKE_RIFC
READ (KLUN) YD%ETKE_R
READ (KLUN) YD%ETKE_OLAM
READ (KLUN) YD%ETKE_LAM0
READ (KLUN) YD%ETKE_LAM1
READ (KLUN) YD%ETKE_LAM2
READ (KLUN) YD%ETKE_LAM3
READ (KLUN) YD%ETKE_LAM4
READ (KLUN) YD%ETKE_KA1
READ (KLUN) YD%ETKE_KA2
READ (KLUN) YD%ETKE_KA3
READ (KLUN) YD%ENT_LAMBDA
READ (KLUN) YD%ETKE_CG01
READ (KLUN) YD%ETKE_CG02
READ (KLUN) YD%ETKE_CG03
READ (KLUN) YD%ETKE_BETA_EPS
READ (KLUN) YD%ETKE_GAMMA_EPS
READ (KLUN) YD%ETKE_GAMD
READ (KLUN) YD%ETKE_TALPH
READ (KLUN) YD%ETKE_ALPH0
READ (KLUN) YD%ETKE_ENTRX
READ (KLUN) YD%ETKE_ENTRN
READ (KLUN) YD%ETKE_KLM
READ (KLUN) YD%ETKE_TAULM
READ (KLUN) YD%ETKE_C0SHEAR
READ (KLUN) YD%ETKE_R1SIM
READ (KLUN) YD%ETKE_R2SIM
READ (KLUN) YD%ETKE_GB08A
READ (KLUN) YD%ETKE_GB08B
READ (KLUN) YD%ETKE_MIN
READ (KLUN) YD%ETKE_CRIT
READ (KLUN) YD%ETKE_DELTA
READ (KLUN) YD%EFB_AZ0
READ (KLUN) YD%EFB_UR
READ (KLUN) YD%REFB_1
READ (KLUN) YD%REFB_2
READ (KLUN) YD%REFB_3
READ (KLUN) YD%TUDBU
READ (KLUN) YD%TDDBU
READ (KLUN) YD%TUDFR
READ (KLUN) YD%TDDFR
READ (KLUN) YD%GCVALMX
READ (KLUN) YD%GCVTAUDE
READ (KLUN) YD%GCVACHI
READ (KLUN) YD%GCVBEE
READ (KLUN) YD%GCVEEX
READ (KLUN) YD%ECMNPI
READ (KLUN) YD%GRRMINA
READ (KLUN) YD%GDDBETA
READ (KLUN) YD%GDDDP
READ (KLUN) YD%GDDFXM
READ (KLUN) YD%GDDWPF
READ (KLUN) YD%GDDEVF
READ (KLUN) YD%TENTRD
READ (KLUN) YD%GDDALBU
READ (KLUN) YD%GDDFRAC
READ (KLUN) YD%GDDENDYMX
READ (KLUN) YD%GDDFP
READ (KLUN) YD%GDDTAUSIG
READ (KLUN) YD%GPEIPHI
READ (KLUN) YD%GPETAU
READ (KLUN) YD%GPEFDC
READ (KLUN) YD%GENVSRH
READ (KLUN) YD%GCVKSKV
READ (KLUN) YD%GCVALBU
READ (KLUN) YD%GCVENDY1
READ (KLUN) YD%GCVENDY2
READ (KLUN) YD%GCVENDYMX
READ (KLUN) YD%GCVIDPBAS
READ (KLUN) YD%GCVTAUSIG
READ (KLUN) YD%GTRGDPMIX
READ (KLUN) YD%GTRGDPHIMN
READ (KLUN) YD%GTRGPUSLMN
READ (KLUN) YD%GTRGKCK9
READ (KLUN) YD%GTRGAIN
READ (KLUN) YD%GTRTHRS
READ (KLUN) YD%GTRTHCK
READ (KLUN) YD%GTRBRC
READ (KLUN) YD%GTRKGAIN
READ (KLUN) YD%GTRKTHRS
READ (KLUN) YD%GTRKTHCK
READ (KLUN) YD%GCVCATAU
READ (KLUN) YD%GCATHRCAP
READ (KLUN) YD%GCATHRMOC
READ (KLUN) YD%GCATHRCND
READ (KLUN) YD%GCAOMCND
READ (KLUN) YD%NWEIGHT
READ (KLUN) YD%NCATAU
READ (KLUN) YD%NCAPEMAX
READ (KLUN) YD%NCVGMAX
READ (KLUN) YD%RNEGAT
READ (KLUN) YD%RNLCURV
READ (KLUN) YD%EDK
READ (KLUN) YD%XKLM
READ (KLUN) YD%AGRE1
READ (KLUN) YD%AGRERICR
READ (KLUN) YD%AJBUMIN
READ (KLUN) YD%RCOFLM
READ (KLUN) YD%TENTRVL
READ (KLUN) YD%TRENTRV
READ (KLUN) YD%GCVGAMMA
READ (KLUN) YD%LKESC
READ (KLUN) YD%AGRE2
READ (KLUN) YD%AGREF
READ (KLUN) YD%ALFX
READ (KLUN) YD%ALFX_LR
READ (KLUN) YD%ALFX_HR
READ (KLUN) YD%TCTC
READ (KLUN) YD%TVFC
READ (KLUN) YD%GAMAP1
READ (KLUN) YD%RKDN
READ (KLUN) YD%VVN
READ (KLUN) YD%VVX
READ (KLUN) YD%FENTRT
READ (KLUN) YD%FQLIC
READ (KLUN) YD%FNEBC
READ (KLUN) YD%FEVAPC
READ (KLUN) YD%RDPHIC
READ (KLUN) YD%RWBF1
READ (KLUN) YD%RWBF2
READ (KLUN) YD%SCLESPR
READ (KLUN) YD%SCLESPS
READ (KLUN) YD%HUCRED
READ (KLUN) YD%HUCREDRA
READ (KLUN) YD%FSPRAIN
READ (KLUN) YD%EFFCOLL
READ (KLUN) YD%RSMDNEBX
READ (KLUN) YD%RSMDTX
READ (KLUN) YD%NSMTPA
READ (KLUN) YD%NSMTPB
READ (KLUN) YD%RKFBTAU
READ (KLUN) YD%RKFBNBX
READ (KLUN) YD%GCVHMIN
READ (KLUN) YD%GCVRESN
READ (KLUN) YD%GCVRESX
READ (KLUN) YD%GMIRH
READ (KLUN) YD%RLMLH1
READ (KLUN) YD%RPRTH
READ (KLUN) YD%RSMOOTHMELT
READ (KLUN) YD%LADVLIM
READ (KLUN) YD%LGDDD
READ (KLUN) YD%LCVNHD
READ (KLUN) YD%LCVRESDYN
READ (KLUN) YD%LCVMICC
READ (KLUN) YD%GMUKEDD
READ (KLUN) YD%GNHDTAT
READ (KLUN) YD%GNHDSMOS
READ (KLUN) YD%GNHDSMOT
READ (KLUN) YD%GNHDEV
READ (KLUN) YD%LGVVEX
READ (KLUN) YD%LCVUVM
READ (KLUN) YD%NCVENTR
READ (KLUN) YD%NCVSIG
READ (KLUN) YD%NCVCLOS
READ (KLUN) YD%NCVQLI
READ (KLUN) YD%GCVENTRN
READ (KLUN) YD%GCVENTRX
READ (KLUN) YD%ADOE
READ (KLUN) YD%RFRAC_ENTR_N
READ (KLUN) YD%RFRAC_ENTR_X
READ (KLUN) YD%GCVENTR_MIN
READ (KLUN) YD%THPCMT
READ (KLUN) YD%AJ1PEPS
READ (KLUN) YD%AJ1MEPS
READ (KLUN) YD%NAJITER
READ (KLUN) YD%GAEPS
READ (KLUN) YD%GCVEZ
READ (KLUN) YD%GCVTRMIN
READ (KLUN) YD%LCVFEVV
READ (KLUN) YD%GCVFEVV
READ (KLUN) YD%LCVCONTAU
READ (KLUN) YD%GCVTEXC
READ (KLUN) YD%GCVWEXC
READ (KLUN) YD%LCVNAUV
READ (KLUN) YD%GCVFRR
READ (KLUN) YD%GCVPNH
READ (KLUN) YD%GCVORGED
READ (KLUN) YD%LCVIMPT
READ (KLUN) YD%GCVTAUREM
READ (KLUN) YD%GCLOEA
READ (KLUN) YD%GCLOEB
READ (KLUN) YD%GFRAE
READ (KLUN) YD%GCVADET
READ (KLUN) YD%GCVCINC
READ (KLUN) YD%GSDMIN
READ (KLUN) YD%GSDMAX
READ (KLUN) YD%GALMIN
READ (KLUN) YD%GALMAX
READ (KLUN) YD%GSDAMIN
READ (KLUN) YD%GSDAMAX
READ (KLUN) YD%GEXPKD
READ (KLUN) YD%LCVEOD
READ (KLUN) YD%GREMIN
READ (KLUN) YD%GREMAX
READ (KLUN) YD%GCHI0
READ (KLUN) YD%GFSURF
READ (KLUN) YD%GSHELL
READ (KLUN) YD%GFRIC
READ (KLUN) YD%GUDDD
READ (KLUN) YD%GSIGA
READ (KLUN) YD%GNHDSMOW
READ (KLUN) YD%GDEPTH
READ (KLUN) YD%GALTAU
READ (KLUN) YD%GKEDDRE
READ (KLUN) YD%GNHACC
READ (KLUN) YD%GTDCL
READ (KLUN) YD%GSINHD
READ (KLUN) YD%GSINHR
READ (KLUN) YD%GCVFNER
READ (KLUN) YD%GCVFNEO
READ (KLUN) YD%GCVFNEP1
READ (KLUN) YD%GCVFNEP2
READ (KLUN) YD%GRBCC
READ (KLUN) YD%GTOPDEPTH
READ (KLUN) YD%GCVTSMO
READ (KLUN) YD%RKDX
READ (KLUN) YD%LCAPCIN
READ (KLUN) YD%LCORSEDIM
READ (KLUN) YD%GNHDTAU
READ (KLUN) YD%GRSO
READ (KLUN) YD%GRTH
READ (KLUN) YD%GRFCS
READ (KLUN) YD%GCVRE
READ (KLUN) YD%LSBUO
READ (KLUN) YD%GREDDI
READ (KLUN) YD%GREDDL
READ (KLUN) YD%GREDDR
READ (KLUN) YD%GREDDS
READ (KLUN) YD%LCVTADV
READ (KLUN) YD%LCVDS
READ (KLUN) YD%GCVUV
READ (KLUN) YD%GCVGAW
READ (KLUN) YD%GCVGAX
READ (KLUN) YD%GCHECKMV_TMIN
READ (KLUN) YD%GCHECKMV_TMAX
READ (KLUN) YD%GCHECKMV_QVMIN
READ (KLUN) YD%GCHECKMV_QVMAX
READ (KLUN) YD%LGPRONI1
READ (KLUN) YD%NPRONI
READ (KLUN) YD%GPRONI
READ (KLUN) YD%RNEBCX
READ (KLUN) YD%GLIGHTT1
READ (KLUN) YD%GLIGHTT2
READ (KLUN) YD%GLIGHTT3
READ (KLUN) YD%REFLRHC
READ (KLUN) YD%TEQH
READ (KLUN) YD%REFLKUO
READ (KLUN) YD%REFLCAPE
READ (KLUN) YD%TEQK
READ (KLUN) YD%TEQC
READ (KLUN) YD%REPS
READ (KLUN) LRHUC
IF (LRHUC) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RHUC (IL1(1):IU1(1)))
  READ (KLUN) YD%RHUC
ENDIF
READ (KLUN) LRQSMOD
IF (LRQSMOD) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RQSMOD (IL1(1):IU1(1)))
  READ (KLUN) YD%RQSMOD
ENDIF
READ (KLUN) LRSURF
IF (LRSURF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RSURF (IL1(1):IU1(1)))
  READ (KLUN) YD%RSURF
ENDIF
READ (KLUN) LRN1D
IF (LRN1D) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RN1D (IL1(1):IU1(1)))
  READ (KLUN) YD%RN1D
ENDIF
READ (KLUN) LRRC1D
IF (LRRC1D) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RRC1D (IL1(1):IU1(1)))
  READ (KLUN) YD%RRC1D
ENDIF
READ (KLUN) LRSRC1D
IF (LRSRC1D) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RSRC1D (IL1(1):IU1(1)))
  READ (KLUN) YD%RSRC1D
ENDIF
READ (KLUN) YD%RCOEFRAIN
READ (KLUN) YD%RCOEFSNOW
END SUBROUTINE


SUBROUTINE COPY_TPHY0 (YD, LDCREATED)
IMPLICIT NONE
TYPE (TPHY0), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED
LOGICAL :: LLCREATED
LOGICAL :: LRHUC, LRN1D, LRQSMOD, LRRC1D, LRSRC1D, LRSURF

LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$acc enter data create (YD)
  !$acc update device (YD)
ENDIF
































































































































































































































































































































































































































































LRHUC = ALLOCATED (YD%RHUC)
IF (LRHUC) THEN
  !$acc enter data create (YD%RHUC)
  !$acc update device (YD%RHUC)
  !$acc enter data attach (YD%RHUC)
ENDIF

LRQSMOD = ALLOCATED (YD%RQSMOD)
IF (LRQSMOD) THEN
  !$acc enter data create (YD%RQSMOD)
  !$acc update device (YD%RQSMOD)
  !$acc enter data attach (YD%RQSMOD)
ENDIF

LRSURF = ALLOCATED (YD%RSURF)
IF (LRSURF) THEN
  !$acc enter data create (YD%RSURF)
  !$acc update device (YD%RSURF)
  !$acc enter data attach (YD%RSURF)
ENDIF

LRN1D = ALLOCATED (YD%RN1D)
IF (LRN1D) THEN
  !$acc enter data create (YD%RN1D)
  !$acc update device (YD%RN1D)
  !$acc enter data attach (YD%RN1D)
ENDIF

LRRC1D = ALLOCATED (YD%RRC1D)
IF (LRRC1D) THEN
  !$acc enter data create (YD%RRC1D)
  !$acc update device (YD%RRC1D)
  !$acc enter data attach (YD%RRC1D)
ENDIF

LRSRC1D = ALLOCATED (YD%RSRC1D)
IF (LRSRC1D) THEN
  !$acc enter data create (YD%RSRC1D)
  !$acc update device (YD%RSRC1D)
  !$acc enter data attach (YD%RSRC1D)
ENDIF



END SUBROUTINE

SUBROUTINE WIPE_TPHY0 (YD, LDDELETED)
IMPLICIT NONE
TYPE (TPHY0), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED
LOGICAL :: LLDELETED
LOGICAL :: LRHUC, LRN1D, LRQSMOD, LRRC1D, LRSRC1D, LRSURF

































































































































































































































































































































































































































































LRHUC = ALLOCATED (YD%RHUC)
IF (LRHUC) THEN
  !$acc exit data detach (YD%RHUC)
  !$acc exit data delete (YD%RHUC)
ENDIF

LRQSMOD = ALLOCATED (YD%RQSMOD)
IF (LRQSMOD) THEN
  !$acc exit data detach (YD%RQSMOD)
  !$acc exit data delete (YD%RQSMOD)
ENDIF

LRSURF = ALLOCATED (YD%RSURF)
IF (LRSURF) THEN
  !$acc exit data detach (YD%RSURF)
  !$acc exit data delete (YD%RSURF)
ENDIF

LRN1D = ALLOCATED (YD%RN1D)
IF (LRN1D) THEN
  !$acc exit data detach (YD%RN1D)
  !$acc exit data delete (YD%RN1D)
ENDIF

LRRC1D = ALLOCATED (YD%RRC1D)
IF (LRRC1D) THEN
  !$acc exit data detach (YD%RRC1D)
  !$acc exit data delete (YD%RRC1D)
ENDIF

LRSRC1D = ALLOCATED (YD%RSRC1D)
IF (LRSRC1D) THEN
  !$acc exit data detach (YD%RSRC1D)
  !$acc exit data delete (YD%RSRC1D)
ENDIF



LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$acc exit data delete (YD)
ENDIF
END SUBROUTINE



END MODULE
